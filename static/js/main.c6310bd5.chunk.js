(this.webpackJsonpmesto2=this.webpackJsonpmesto2||[]).push([[0],{11:function(e,t,n){e.exports=n(17)},16:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(8),i=n.n(r),u=(n(16),n(10)),c=n(1),s=n(9),l=n.n(s);var p=function(){return o.a.createElement("header",{className:"header"},o.a.createElement("img",{className:"logo",alt:"\u041c\u0435\u0441\u0442\u043e \u0432 \u0420\u043e\u0441\u0441\u0438\u0438",src:l.a}))},m=o.a.createContext();var _=function(e){var t=e.card,n=e.onCardClick,a=e.onCardLike,r=e.onCardDelete,i=o.a.useContext(m),u=t.owner._id===i._id,c="button card__delete-button ".concat(u?"card__delete-button_visible":"card__delete-button_hidden"),s=t.likes.some((function(e){return e._id===i._id})),l="button card__like-button ".concat(s&&"card__like-button_pressed");return o.a.createElement("li",{className:"card"},o.a.createElement("img",{src:t.link,alt:"",className:"card__image",onClick:function(){n(t)}}),o.a.createElement("button",{className:c,type:"button",onClick:function(){r(t)}}),o.a.createElement("div",{className:"card__caption"},o.a.createElement("h2",{className:"card__title"},t.name),o.a.createElement("div",{className:"card__like-container"},o.a.createElement("button",{className:l,type:"button",onClick:function(){a(t)}}),o.a.createElement("p",{className:"card__like-counter"},t.likes.length))))};var f=function(e){var t=e.onEditProfile,n=e.onAddPlace,a=e.onEditAvatar,r=e.onCardClick,i=e.cards,u=e.onCardLike,c=e.onCardDelete,s=o.a.useContext(m);return o.a.createElement("main",{className:"content"},o.a.createElement("section",{className:"profile"},o.a.createElement("img",{src:s.avatar,alt:"\u0444\u043e\u0442\u043e \u043f\u0440\u043e\u0444\u0438\u043b\u044f",className:"profile__avatar",onClick:a}),o.a.createElement("div",{className:"profile__info"},o.a.createElement("h1",{className:"profile__name"},s.name),o.a.createElement("button",{className:"button profile__edit-button",type:"button","aria-label":"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",onClick:t}),o.a.createElement("p",{className:"profile__occupation"},s.about)),o.a.createElement("button",{className:"button profile__add-button",type:"button","aria-label":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",onClick:n})),o.a.createElement("section",null,o.a.createElement("ul",{className:"cards"},i.map((function(e){return o.a.createElement(_,{key:e._id,card:e,onCardClick:r,onCardLike:u,onCardDelete:c})})))))};var d=function(){return o.a.createElement("footer",{className:"footer"},o.a.createElement("p",{className:"footer__copyright"},"\xa92020 Mesto Russia"))},h=n(4),v=n.n(h);var E=function(e){var t=e.title,n=e.name,a=e.submitText,r=e.isOpen,i=e.onClose,u=e.onSubmit,c=e.children,s="popup popup_type_".concat(n," ").concat(r&&"popup_opened");return o.a.createElement("div",{className:s},o.a.createElement("form",{name:n,onSubmit:u,className:"popup__container popup__container_type_input",noValidate:!0},o.a.createElement("p",{className:"popup__text"},t),c,o.a.createElement("button",{type:"submit",className:"button popup__save-button"},a),o.a.createElement("button",{type:"reset",className:"button popup__close-button popup__close-button_type_input",onClick:i},o.a.createElement("img",{src:v.a,alt:"\u0437\u0430\u043a\u0440\u044b\u0442\u044c"}))))},b=n(5),k=n(6),C=function(){function e(t,n){Object(b.a)(this,e),this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._formElement=n}return Object(k.a)(e,[{key:"enableValidation",value:function(){this._getInputList(),this._getSubmitButtonElement(),this._formElement.addEventListener("submit",(function(e){e.preventDefault()})),this._setEventListeners()}},{key:"clearErrors",value:function(){var e=this;this._inputList.forEach((function(t){e._hideInputError(t)})),this._toggleSubmitButtonState(this._submitButton)}},{key:"_toggleSubmitButtonState",value:function(){this._hasInvalidInput(this._inputList)?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0)):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.removeAttribute("disabled"))}},{key:"_hasInvalidInput",value:function(){return!!this._inputList.some((function(e){return!e.validity.valid}))}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"_hideInputError",value:function(e){var t=this._getErrorElement(e);e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}},{key:"_showInputError",value:function(e,t){var n=this._getErrorElement(e);e.classList.add(this._inputErrorClass),n.classList.add(this._errorClass),n.textContent=t}},{key:"_getInputList",value:function(){var e=Array.from(this._formElement.querySelectorAll(this._inputSelector));return this._inputList=e,this._inputList}},{key:"_getSubmitButtonElement",value:function(){var e=this._formElement.querySelector(this._submitButtonSelector);return this._buttonElement=e,this._buttonElement}},{key:"_getErrorElement",value:function(e){return this._formElement.querySelector(".popup__error_type_".concat(e.name))}},{key:"_setEventListeners",value:function(){var e=this;this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e._toggleSubmitButtonState()})),t.addEventListener("focus",(function(){e._toggleSubmitButtonState()}))}))}}]),e}(),y={formSelector:".popup__container_type_input",inputSelector:".popup__input",submitButtonSelector:".popup__save-button",inactiveButtonClass:"popup__save-button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};var g=function(e){var t=e.isOpen,n=e.onClose,a=e.onUpdateUser,r=o.a.useContext(m),i=o.a.useState(""),u=Object(c.a)(i,2),s=u[0],l=u[1],p=o.a.useState(""),_=Object(c.a)(p,2),f=_[0],d=_[1],h=o.a.useState("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),v=Object(c.a)(h,2),b=v[0],k=v[1],g=o.a.useRef();return o.a.useEffect((function(){var e=document.forms.edit;g.current=new C(y,e),g.current.enableValidation()}),[]),o.a.useEffect((function(){l(r.name),d(r.about),k("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")}),[r]),o.a.useEffect((function(){k("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")}),[t]),o.a.createElement(E,{title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"edit",submitText:b,onClose:function(){l(r.name),d(r.about),g.current.clearErrors(),n()},onSubmit:function(e){k("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435..."),e.preventDefault(),a({name:s,about:f})},isOpen:t},o.a.createElement("input",{name:"name",className:"popup__input popup__input_type_name",type:"text",required:!0,minLength:"2",maxLength:"40",autoComplete:"off",value:s,onChange:function(e){l(e.target.value)}}),o.a.createElement("span",{className:"popup__error popup__error_type_name"}),o.a.createElement("input",{name:"occupation",className:"popup__input popup__input_type_occupation",type:"text",required:!0,minLength:"2",maxLength:"200",autoComplete:"off",value:f,onChange:function(e){d(e.target.value)}}),o.a.createElement("span",{className:"popup__error popup__error_type_occupation"}))};var S=function(e){var t=e.card,n=e.onClose,a="popup popup_type_image ".concat(0!==Object.keys(t).length&&"popup_opened");return o.a.createElement("div",{className:a},o.a.createElement("div",{className:"popup__container popup__container_type_picture"},o.a.createElement("button",{className:"button popup__close-button popup__close-button_type_picture",type:"reset",onClick:n},o.a.createElement("img",{src:v.a,alt:"\u0437\u0430\u043a\u0440\u044b\u0442\u044c"})),o.a.createElement("img",{src:t.link,alt:"",className:"popup__image"}),o.a.createElement("p",{className:"popup__subtitle"},t.name)))},N=new(function(){function e(t){var n=t.userURL,a=t.cardsURL,o=t.token;Object(b.a)(this,e),this._userURL=n,this._cardsURL=a,this._token=o}return Object(k.a)(e,[{key:"userDownload",value:function(){return fetch(this._userURL,{method:"GET",headers:{authorization:this._token}}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f ".concat(e.status))}))}},{key:"cardsDownload",value:function(){return fetch(this._cardsURL,{method:"GET",headers:{authorization:this._token}}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u0432\u044f\u0437\u0438 \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c ".concat(e.status))}))}},{key:"profileDataUpload",value:function(e,t){return fetch(this._userURL,{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440 ".concat(e.status))}))}},{key:"newCardUpload",value:function(e,t){return fetch(this._cardsURL,{method:"POST",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e,link:t})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440 ".concat(e.status))}))}},{key:"deleteCard",value:function(e){var t=this._cardsURL+"/".concat(e);return fetch(t,{method:"DELETE",headers:{authorization:this._token}}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438")}))}},{key:"changeLikeCardStatus",value:function(e,t){var n=this._cardsURL+"/likes/".concat(e);return t?fetch(n,{method:"DELETE",headers:{authorization:this._token}}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u0432\u044f\u0437\u0438 \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c")})):fetch(n,{method:"PUT",headers:{authorization:this._token}}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u0432\u044f\u0437\u0438 \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c")}))}},{key:"avatarUpload",value:function(e){return fetch(this._userURL+"/avatar",{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({avatar:e.link})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0430\u0432\u0430\u0442\u0430\u0440\u0430")}))}}]),e}())({userURL:"https://mesto.nomoreparties.co/v1/cohort-15/users/me",cardsURL:"https://mesto.nomoreparties.co/v1/cohort-15/cards",token:"e6bf7ea4-0157-47ee-b8f8-bf17d3b13ba1"});var L=function(e){var t=e.isOpen,n=e.onClose,a=e.onUpdateAvatar,r=o.a.useRef(),i=o.a.useRef(),u=o.a.useState("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),s=Object(c.a)(u,2),l=s[0],p=s[1];return o.a.useEffect((function(){p("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")}),[t,p]),o.a.useEffect((function(){var e=document.forms.avatar;i.current=new C(y,e),i.current.enableValidation()}),[]),o.a.createElement(E,{title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"avatar",submitText:l,onClose:function(){r.current="",i.current.clearErrors(),n()},onSubmit:function(e){p("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435..."),e.preventDefault(),a(r.current.value)},isOpen:t},o.a.createElement("input",{ref:r,name:"link",className:"popup__input popup__input_type_link",type:"url",required:!0,placeholder:"\u0441\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",autoComplete:"off"}),o.a.createElement("span",{className:"popup__error popup__error_type_link"}))};var j=function(e){var t=e.isOpen,n=e.submitButtonText,a=e.onClose,r=e.onAddPlace,i=o.a.useState(""),u=Object(c.a)(i,2),s=u[0],l=u[1],p=o.a.useState(""),m=Object(c.a)(p,2),_=m[0],f=m[1],d=o.a.useRef();return o.a.useEffect((function(){l(""),f("")}),[t,l,f]),o.a.useEffect((function(){var e=document.querySelector('form[name="new-card"]');d.current=new C(y,e),d.current.enableValidation()}),[]),o.a.createElement(E,{title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"new-card",submitText:n,isOpen:t,onClose:function(){d.current.clearErrors(),a()},onSubmit:function(e){e.preventDefault(),r(s,_)}},o.a.createElement("input",{value:s,onChange:function(e){l(e.target.value)},name:"place",className:"popup__input popup__input_type_place",type:"text",placeholder:"\u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",required:!0,minLength:"1",maxLength:"30",autoComplete:"off"}),o.a.createElement("span",{className:"popup__error popup__error_type_place"}),o.a.createElement("input",{value:_,onChange:function(e){f(e.target.value)},name:"link",className:"popup__input popup__input_type_link",type:"url",required:!0,placeholder:"\u0441\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",autoComplete:"off"}),o.a.createElement("span",{className:"popup__error popup__error_type_link"}))};var O=function(e){var t=e.isOpen,n=e.onClose,a=e.onConfirm,r=o.a.useState("\u0414\u0430"),i=Object(c.a)(r,2),u=i[0],s=i[1];return o.a.useEffect((function(){s("\u0414\u0430")}),[t,s]),o.a.createElement(E,{title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",name:"confirm",submitText:u,isOpen:t,onClose:n,onSubmit:function(e){s("\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435..."),e.preventDefault(),a()}})};var U=function(e){var t=e.message,n="popup popup_type_error ".concat(0!==t.length&&"popup_opened");return o.a.createElement("div",{className:n},o.a.createElement("p",{className:"popup__message"},t))};var w=function(){var e=o.a.useState(!1),t=Object(c.a)(e,2),n=t[0],a=t[1],r=o.a.useState(!1),i=Object(c.a)(r,2),s=i[0],l=i[1],_=o.a.useState("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),h=Object(c.a)(_,2),v=h[0],E=h[1],b=o.a.useState(!1),k=Object(c.a)(b,2),C=k[0],y=k[1],w=o.a.useState(!1),T=Object(c.a)(w,2),x=T[0],B=T[1],P=o.a.useState({}),R=Object(c.a)(P,2),D=R[0],A=R[1],I=o.a.useState({}),q=Object(c.a)(I,2),z=q[0],V=q[1],J=o.a.useState(""),M=Object(c.a)(J,2),G=M[0],H=M[1],W=o.a.useState({}),$=Object(c.a)(W,2),F=$[0],K=$[1],Q=o.a.useState([]),X=Object(c.a)(Q,2),Y=X[0],Z=X[1];function ee(){a(!1),l(!1),y(!1),B(!1),A({}),V({})}return o.a.useEffect((function(){var e=[N.userDownload(),N.cardsDownload()];Promise.all(e).then((function(e){var t=Object(c.a)(e,2),n=t[0],a=t[1];K(n),Z(a)})).catch((function(e){H("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435"),setTimeout((function(){H("")}),2e3)}))}),[]),o.a.createElement(m.Provider,{value:F},o.a.createElement("div",{className:"App"},o.a.createElement("div",{className:"body"},o.a.createElement(p,null),o.a.createElement(f,{onEditProfile:function(){a(!0)},onAddPlace:function(){l(!0)},onEditAvatar:function(){y(!0)},onCardClick:function(e){A(e)},cards:Y,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===F._id}));N.changeLikeCardStatus(e._id,t).then((function(t){var n=Y.map((function(n){return n._id===e._id?t:n}));Z(n)})).catch((function(e){H("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u0432\u044f\u0437\u0438 \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c"),setTimeout((function(){H("")}),2e3)}))},onCardDelete:function(e){B(!0),V(e)}}),o.a.createElement(d,null),o.a.createElement(g,{isOpen:n,onClose:ee,onUpdateUser:function(e){var t=e.name,n=e.about;N.profileDataUpload(t,n).then((function(e){K(e),ee()})).catch((function(e){H("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435"),a(!1),a(!0),setTimeout((function(){H("")}),2e3)}))}}),o.a.createElement(j,{isOpen:s,submitButtonText:v,onClose:ee,onAddPlace:function(e,t){E("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435..."),N.newCardUpload(e,t).then((function(e){Z([e].concat(Object(u.a)(Y))),ee()})).catch((function(e){H("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u0432\u044f\u0437\u0438 \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c"),setTimeout((function(){H("")}),2e3)})).finally((function(){E("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")}))}}),o.a.createElement(L,{isOpen:C,onClose:ee,onUpdateAvatar:function(e){N.avatarUpload({link:e}).then((function(e){K(e),ee()})).catch((function(e){H("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0444\u043e\u0442\u043e \u043f\u0440\u043e\u0444\u0438\u043b\u044f"),y(!1),y(!0),setTimeout((function(){H("")}),2e3)}))}}),o.a.createElement(O,{isOpen:x,onClose:ee,onConfirm:function(){z.owner._id===F._id&&N.deleteCard(z._id).then((function(){var e=Y.filter((function(e){return e._id!==z._id}));Z(e),ee()})).catch((function(e){H("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0443"),B(!1),B(!0),setTimeout((function(){H("")}),2e3)}))}}),o.a.createElement(S,{card:D,onClose:ee}),o.a.createElement(U,{message:G}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(w,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},4:function(e,t,n){e.exports=n.p+"static/media/close-icon.c2d0901f.svg"},9:function(e,t,n){e.exports=n.p+"static/media/logo.855a8c98.svg"}},[[11,1,2]]]);
//# sourceMappingURL=main.c6310bd5.chunk.js.map